# Requirements Traceability Matrix

## Story: 1.3 - Portal Shell & Navigation

### Coverage Summary

- Total Requirements: 5
- Fully Covered: 5 (100%)
- Partially Covered: 0 (0%)
- Not Covered: 0 (0%)

### Requirement Mappings

#### AC1: Dashboard renders status tiles (placeholders for connectors, sync jobs, alerts) using ShadCN components with light/dark mode support.

**Coverage: FULL**

- Scenario `1.3-UNIT-001` (planned file `apps/web/src/components/__tests__/status-card.test.tsx`)
  - Given: The `StatusCard` component receives title, value, description, and aria label props.
  - When: The component is rendered in isolation.
  - Then: It displays all props with correct semantic roles and supports light/dark class names.
  - Coverage: unit

- Scenario `1.3-INT-001` (planned file `apps/web/src/app/(dashboard)/__tests__/dashboard-page.test.tsx`)
  - Given: The dashboard page is rendered with theme provider context.
  - When: The page loads the default dashboard route.
  - Then: Three status tiles (Calendars Synced, Connectors Healthy, Active Alerts) render with placeholders.
  - Coverage: integration

- Scenario `1.3-E2E-001` (Playwright `tests/dashboard/status-cards.spec.ts`)
  - Given: An authenticated administrator session.
  - When: They visit `/app` and toggle between light and dark themes.
  - Then: Three status tiles remain visible with correct labels and theme styling persists.
  - Coverage: e2e

#### AC2: Navigation includes Dashboard, Connectors, Calendars, Logs, and Settings links (non-functional stubs allowed initially).

**Coverage: FULL**

- Scenario `1.3-UNIT-002` (planned file `apps/web/src/components/__tests__/nav-config.test.ts`)
  - Given: The navigation configuration factory is invoked.
  - When: The nav items are generated.
  - Then: It returns five entries with expected labels, hrefs, and aria attributes.
  - Coverage: unit

- Scenario `1.3-E2E-002` (Playwright `tests/dashboard/navigation-a11y.spec.ts`)
  - Given: An authenticated administrator with keyboard navigation.
  - When: They tab through the portal shell.
  - Then: Links for Dashboard, Connectors, Calendars, Logs, and Settings receive focus in order with visible outline and announce proper names.
  - Coverage: e2e

#### AC3: Unified calendar panel placeholder displays instructional text when no calendars are connected.

**Coverage: FULL**

- Scenario `1.3-UNIT-003` (planned file `apps/web/src/components/__tests__/calendar-placeholder.test.tsx`)
  - Given: The unified calendar empty-state component receives an empty calendar list.
  - When: It renders the placeholder.
  - Then: Instructional copy and illustration alt text appear as specified.
  - Coverage: unit

- Scenario `1.3-E2E-003` (Playwright `tests/dashboard/calendar-empty-state.spec.ts`)
  - Given: An authenticated administrator with no calendars provisioned.
  - When: They land on the dashboard.
  - Then: The unified calendar panel shows the instructional text guiding connector setup.
  - Coverage: e2e

#### AC4: Layout is responsive down to 768px width and meets WCAG AA contrast targets in both themes.

**Coverage: FULL**

- Scenario `1.3-INT-002` (planned file `apps/web/src/app/__tests__/layout-accessibility.test.tsx`)
  - Given: The portal layout component renders with skip link and theme provider.
  - When: Focus moves through header and content containers.
  - Then: Skip link, focus outlines, and responsive classes are present.
  - Coverage: integration

- Scenario `1.3-E2E-004` (Playwright `tests/dashboard/responsive-shell.spec.ts`)
  - Given: An authenticated administrator on a 768px viewport.
  - When: They open and close the responsive navigation sheet.
  - Then: Sidebar collapses to the mobile control with focus trapped inside while open and restores main focus when closed.
  - Coverage: e2e

- Scenario `1.3-E2E-005` (Playwright `tests/dashboard/accessibility.spec.ts`)
  - Given: Authenticated sessions in both light and dark themes.
  - When: Axe-core scans the dashboard after theme toggle.
  - Then: No critical accessibility violations occur and contrast thresholds meet WCAG AA.
  - Coverage: e2e

#### Task Dependency: Shell only renders after authentication and redirects unauthenticated users to `/login`.

**Coverage: FULL**

- Scenario `1.3-E2E-006` (Playwright `tests/dashboard/auth-guard.spec.ts`)
  - Given: One unauthenticated and one authenticated browser context.
  - When: Each visits the portal shell route.
  - Then: The unauthenticated context redirects to `/login`, while the authenticated context stays on dashboard with shell rendered.
  - Coverage: e2e

### Critical Gaps

- None identified; all requirements have at least one validating test at an appropriate level.

### Test Design Recommendations

- Ensure unit and integration suites run in CI ahead of Playwright to provide fast failure signals for navigation and status tile regressions.
- Reuse authenticated session fixtures from Story 1.2 to avoid duplication and speed up E2E execution.

### Risk Assessment

- All current requirements covered; monitor for additional NFRs (performance/observability) once live data replaces placeholders.

