# Status
Ready for Review

# Story
**As a** self-hosting administrator reviewing SynCal docs,
**I want** all references to the encryption secret to use the same `ENCRYPTION_KEY` name,
**so that** setup, security reviews, and runbooks stay consistent with the implemented configuration helpers.

This work supports Epic 1 – Platform Foundation & Secure Portal by keeping security documentation aligned with the deployed helpers.

# Acceptance Criteria
1. Every repo document referencing `ENCRYPTION_MASTER_KEY` is updated (or clarified) to `ENCRYPTION_KEY`, including:
   - `docs/architecture/code-review-guidelines.md#security`
   - `docs/architecture/ops-runbook.md#secrets-rotation`
   - `docs/prd/roles-and-responsibilities.md#secrets-ownership`
   - `docs/prd/provider-credentials-setup.md#example-environment-keys`
   - `docs/prd/epic-2-connector-configuration-validation.md#story-24-connector-encryption-secret-management`
2. Updated docs explicitly note the base64 requirement and tie back to the shared config helper expectations (`packages/config/src/index.ts`, `.env.example`, `docs/architecture/local-development.md#1-environment-setup`).
3. A final repository-wide search confirms no stray `ENCRYPTION_MASTER_KEY` usages remain (excluding change logs/history where appropriate).

# Tasks / Subtasks
- [x] Update architecture docs (AC 1, 2)
  - [x] Revise `docs/architecture/code-review-guidelines.md#security` to reference `ENCRYPTION_KEY` in security checks and cite the base64 expectation from the shared config helpers.
  - [x] Adjust `docs/architecture/ops-runbook.md#secrets-rotation` secrets rotation/troubleshooting steps to match the new env name and validation behavior, referencing `.env.example` for base64 guidance.

- [x] Update PRD documentation (AC 1, 2)
  - [x] Refresh `docs/prd/roles-and-responsibilities.md#secrets-ownership` so ownership tables and responsibilities cite `ENCRYPTION_KEY` and point back to the central config helper docs.
  - [x] Align `docs/prd/provider-credentials-setup.md#example-environment-keys` guidance and snippets (env blocks, connector notes) with `ENCRYPTION_KEY`, including explicit base64 notes sourced from `.env.example` and the local development guide.
  - [x] Update `docs/prd/epic-2-connector-configuration-validation.md#story-24-connector-encryption-secret-management` technical guidance to reference the correct key name, reiterating the base64 requirement and helper alignment.

- [x] Consistency validation (AC 3)
  - [x] Run `rg "ENCRYPTION_MASTER_KEY"` (or equivalent) to ensure no lingering references remain outside approved historical sections.
  - [x] Note results in Completion Notes, capturing the command used.

# Dev Notes
- Existing configuration helpers (`packages/config`) and `.env.example` already use `ENCRYPTION_KEY`; this story only updates documentation artifacts.
- Keep historical change logs intact; if quoting prior behavior, add clarifying text instead of rewriting history.
- Ensure any doc screenshots or code samples that include env snippets are updated if present (none identified yet; confirm while editing).
- Coordinate with QA to re-verify `docs/stories/1.1.bootstrap-project-docker-stack.md` QA notes once sweep completes.

## Testing
- Run `npm run lint` to catch documentation formatting regressions (lint pipeline placeholder still required) [Source: docs/architecture/test-strategy-and-standards.md#continuous-testing]
- Manual validation: `rg "ENCRYPTION_MASTER_KEY"` returns no stray hits outside approved history sections [Source: docs/architecture/ops-runbook.md#secrets-rotation]

# Change Log
| Date       | Version | Description               | Author       |
|------------|---------|---------------------------|--------------|
| 2025-09-18 | v0.1    | Initial draft (Doc sweep) | Product Owner |

# Dev Agent Record
## Agent Model Used
GPT-5 (Codex)
## Debug Log References
- n/a
## Completion Notes List
- Updated architecture and PRD docs to reference `ENCRYPTION_KEY` and cite the shared config helper plus `.env.example` / local dev guidance for base64 handling.
- `npm run lint` → `lint pipeline not yet configured` (expected placeholder output).
- `rg "ENCRYPTION_MASTER_KEY"` now only reports occurrences inside story documentation (`docs/stories/...`).
## File List
- docs/architecture/code-review-guidelines.md
- docs/architecture/ops-runbook.md
- docs/prd/roles-and-responsibilities.md
- docs/prd/provider-credentials-setup.md
- docs/prd/epic-2-connector-configuration-validation.md
- docs/stories/1.5.env-key-doc-alignment.md
# QA Results
